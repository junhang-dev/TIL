# [TIL] EC2 네트워킹: 보안 그룹(포트)과 탄력적 IP(EIP)의 필요성

**Date:** 2025-11-07

## 1. 보안 그룹 (Security Group)

* **개념:** EC2 인스턴스의 가상 "방화벽". 특정 IP와 포트만 허용하는 'Inbound Rules(인바운드 규칙)'가 핵심이다.
* **나의 Firecrawl 서버 설정:**
    * **규칙 1 (SSH 접속):**
        * `유형`: SSH
        * `포트`: 22
        * `소스`: `내 IP` (보안을 위해 내 PC의 IP 주소만 접속 허용)
    * **규칙 2 (Firecrawl API):**
        * `유형`: 사용자 지정 TCP
        * `포트`: 3002 (Firecrawl API 기본 포트)
        * `소스`: `0.0.0.0/0` (Anywhere. 내 로컬 PC의 Python 에이전트가 접속해야 하므로)

## 2. 동적 IP vs 탄력적 IP (Elastic IP)

### 1) 문제 상황: 동적 IP (현재 나의 방식)

* `인스턴스 중지(Stop)` 후 `시작(Start)`할 때마다 **퍼블릭 IPv4 주소가 계속 변경된다.**
* 이로 인해 매번 개발을 재개할 때마다 2가지 수동 작업을 해야 한다.
    1.  VS Code SSH 접속 경로 (`.ssh/config` 또는 Remote-SSH 설정)의 IP 주소 변경.
    2.  Python 에이전트 코드(`tools.py`)의 `api_url`에 있는 IP 주소 변경.

### 2) 해결책: 탄력적 IP (Elastic IP)

* **개념:** 인스턴스에 할당할 수 있는 **'고정' 퍼블릭 IP 주소.**
* **장점:** 인스턴스를 중지했다가 다시 시작해도 IP가 변경되지 않아 위 1), 2)번의 수동 작업을 할 필요가 없다.

### 3) 비용에 대한 핵심 학습

* **"탄력적 IP는 공짜가 아니다."**
* AWS의 IPv4 주소는 고갈 자원이므로, '사용하지 않고 점유'하는 것을 막기 위해 비용을 부과한다.
* **Case 1: EIP + 실행 중인 인스턴스 = 💎 무료**
    * IP를 할당받아 `실행 중(Running)`인 인스턴스에 연결해두면 비용이 부과되지 않는다.
* **Case 2: EIP + 중지된 인스턴스 = 💰 유료**
    * IP를 '점유'한 채로 인스턴스를 `중지(Stop)`하면, "왜 IP는 안 쓰면서 잡고 있어?"라며 **유휴 IP 비용이 과금된다.**
* **Case 3: EIP만 할당 (연결 안 함) = 💰 유료**

### 4) 나의 결론

* 나의 사용 패턴: "개발할 때만 잠깐 켜고, 끝나면 바로 `중지(Stop)`한다."
* **결론:** 나의 패턴에서는 **탄력적 IP를 쓰는 것이 오히려 비용이 더 든다.** (Case 2 해당)
* **Trade-off:** 약간의 편의성(고정 IP)을 포기하고, 매번 IP를 수동으로 바꾸는 대신 EIP 유휴 비용(월 몇 천원)을 절약한다. **이것이 나의 최적 비용 전략이다.**
